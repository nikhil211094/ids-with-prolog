Intrusion detection system with prolog KB